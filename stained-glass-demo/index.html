<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stained Glass Demo - Simon Arneberg</title>
    <link rel="icon" type="image/svg+xml" href="../assets/images/favicon-pine-layered.svg">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400&family=Playfair+Display:wght@400;700;900&family=Source+Sans+3:wght@400;600&family=Caveat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .demo-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
        }

        .demo-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .demo-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .demo-header p {
            font-family: 'Merriweather', serif;
            color: #555;
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Source Sans 3', sans-serif;
            transition: background-color 0.3s;
        }

        .file-input-label:hover {
            background-color: #2980b9;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Source Sans 3', sans-serif;
            font-size: 1em;
            transition: all 0.3s;
        }

        .btn-clear {
            background-color: #e74c3c;
            color: white;
        }

        .btn-clear:hover {
            background-color: #c0392b;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            position: relative;
        }

        #editor-canvas {
            border: 3px solid #34495e;
            border-radius: 8px;
            cursor: crosshair;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 100%;
            height: auto;
        }

        .placeholder {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            border: 3px dashed #bdc3c7;
            border-radius: 8px;
            background-color: #ecf0f1;
            color: #7f8c8d;
            font-family: 'Merriweather', serif;
            font-size: 1.2em;
        }

        .point-count {
            font-family: 'Source Sans 3', sans-serif;
            color: #555;
            margin-left: auto;
            padding: 10px 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }

        .instructions {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            border-radius: 5px;
        }

        .instructions h3 {
            font-family: 'Playfair Display', serif;
            margin-top: 0;
            color: #2c3e50;
        }

        .instructions ul {
            font-family: 'Merriweather', serif;
            line-height: 1.8;
            color: #555;
        }
    </style>
</head>
<body>
    <div class="paper-texture"></div>

    <nav class="main-nav">
        <ul>
            <li><a href="/" class="home-icon" title="Home">
                <svg viewBox="0 0 32 32" width="32" height="36">
                    <!-- Polaroid frame background -->
                    <rect x="0" y="0" width="32" height="32" fill="#4a6b7c" rx="1.5"/>
                    <!-- Shadow/border for depth -->
                    <rect x="0" y="0" width="32" height="32" fill="none" stroke="#3d5a68" stroke-width="0.8" rx="1.5"/>
                    <!-- Photo area -->
                    <rect x="3" y="3" width="26" height="20" fill="#e3e8ed"/>
                    <!-- Photo border -->
                    <rect x="3" y="3" width="26" height="20" fill="none" stroke="#d0d0d0" stroke-width="0.5"/>
                    <!-- House icon -->
                    <path d="M16 9l-7 5.5h1.5v5h4v-3.5h3v3.5h4v-5h1.5L16 9z" fill="#2d3f3a"/>
                </svg>
            </a></li>
            <li><a href="/about/">About</a></li>
            <li><a href="/blog/">Projects & Ideas</a></li>
            <li><a href="/music/">Music</a></li>
            <li><a href="/resume/">Resume</a></li>
            <li><a href="/contact/">Contact</a></li>
        </ul>
    </nav>

    <main class="demo-container">
        <div class="demo-header">
            <h1>Stained Glass Design Tool</h1>
            <p>Upload an image and place points to design your stained glass pattern</p>
        </div>

        <div class="controls">
            <div class="file-input-wrapper">
                <input type="file" id="image-upload" accept="image/*">
                <label for="image-upload" class="file-input-label">Upload Image</label>
            </div>
            <button id="clear-btn" class="btn btn-clear">Clear All Points</button>
            <div class="point-count">
                <span>Points: <strong id="point-counter">0</strong></span>
            </div>
        </div>

        <div class="canvas-container">
            <div id="placeholder" class="placeholder">
                Upload an image to get started
            </div>
            <canvas id="editor-canvas" style="display: none;"></canvas>
        </div>

        <div class="instructions">
            <h3>How to Use</h3>
            <ul>
                <li><strong>Upload an Image:</strong> Click the "Upload Image" button to select a photo from your device</li>
                <li><strong>Add Points:</strong> Click anywhere on the image to place a point</li>
                <li><strong>Clear All:</strong> Click "Clear All Points" to remove all points and start over</li>
            </ul>
        </div>
    </main>

    <footer class="site-footer">
        <p>&copy; 2026 Simon Arneberg</p>
    </footer>

    <script>
        const canvas = document.getElementById('editor-canvas');
        const ctx = canvas.getContext('2d');
        const imageUpload = document.getElementById('image-upload');
        const clearBtn = document.getElementById('clear-btn');
        const placeholder = document.getElementById('placeholder');
        const pointCounter = document.getElementById('point-counter');

        let points = [];
        let uploadedImage = null;
        let scale = 1;

        // Handle image upload
        imageUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    uploadedImage = img;

                    // Calculate canvas size to fit the image while maintaining aspect ratio
                    const maxWidth = 1000;
                    const maxHeight = 700;

                    let width = img.width;
                    let height = img.height;

                    if (width > maxWidth) {
                        height = (maxWidth / width) * height;
                        width = maxWidth;
                    }

                    if (height > maxHeight) {
                        width = (maxHeight / height) * width;
                        height = maxHeight;
                    }

                    canvas.width = width;
                    canvas.height = height;
                    scale = width / img.width;

                    // Hide placeholder and show canvas
                    placeholder.style.display = 'none';
                    canvas.style.display = 'block';

                    // Clear any existing points
                    points = [];
                    updatePointCounter();

                    // Draw the image
                    redrawCanvas();
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        // Handle canvas clicks to add points
        canvas.addEventListener('click', function(e) {
            if (!uploadedImage) return;

            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // Adjust for canvas scaling
            const canvasX = x * (canvas.width / rect.width);
            const canvasY = y * (canvas.height / rect.height);

            points.push({ x: canvasX, y: canvasY });
            updatePointCounter();
            redrawCanvas();
        });

        // Clear all points
        clearBtn.addEventListener('click', function() {
            points = [];
            updatePointCounter();
            if (uploadedImage) {
                redrawCanvas();
            }
        });

        // Redraw the canvas with image and points
        function redrawCanvas() {
            if (!uploadedImage) return;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw the image
            ctx.drawImage(uploadedImage, 0, 0, canvas.width, canvas.height);

            // Draw all points
            points.forEach((point, index) => {
                drawPoint(point.x, point.y, index + 1);
            });
        }

        // Draw a single point with a number label
        function drawPoint(x, y, number) {
            // Draw outer circle (white border)
            ctx.beginPath();
            ctx.arc(x, y, 8, 0, 2 * Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Draw inner circle (red dot)
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, 2 * Math.PI);
            ctx.fillStyle = '#e74c3c';
            ctx.fill();

            // Draw number label
            ctx.font = 'bold 12px Arial';
            ctx.fillStyle = 'white';
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            // Draw text with outline
            ctx.strokeText(number, x + 15, y - 15);
            ctx.fillText(number, x + 15, y - 15);
        }

        // Update point counter display
        function updatePointCounter() {
            pointCounter.textContent = points.length;
        }
    </script>
</body>
</html>
